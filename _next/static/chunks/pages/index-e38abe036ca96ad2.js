(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(5746)}])},5746:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return ti}});var n=r(5893),o=r(8993),i=r.n(o),s=r(7294),l=function(t,e){return(l=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function u(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function c(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function p(t,e,r){if(r||2==arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}function f(t){return"function"==typeof t}function d(t){var e=t(function(t){Error.call(t),t.stack=Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var h=d(function(t){return function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}});function v(t,e){if(t){var r=t.indexOf(e);0<=r&&t.splice(r,1)}}var y=function(){var t;function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t,e,r,n,o,i=this._parentage;if(i){if(this._parentage=null,Array.isArray(i))try{for(var s=c(i),l=s.next();!l.done;l=s.next())l.value.remove(this)}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}else i.remove(this)}var u=this.initialTeardown;if(f(u))try{u()}catch(t){o=t instanceof h?t.errors:[t]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var v=c(d),y=v.next();!y.done;y=v.next()){var b=y.value;try{m(b)}catch(t){o=null!=o?o:[],t instanceof h?o=p(p([],a(o)),a(t.errors)):o.push(t)}}}catch(t){r={error:t}}finally{try{y&&!y.done&&(n=v.return)&&n.call(v)}finally{if(r)throw r.error}}}if(o)throw new h(o)}},e.prototype.add=function(t){var r;if(t&&t!==this){if(this.closed)m(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}}},e.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},e.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},e.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&v(e,t)},e.prototype.remove=function(t){var r=this._finalizers;r&&v(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),b=y.EMPTY;function x(t){return t instanceof y||t&&"closed"in t&&f(t.remove)&&f(t.add)&&f(t.unsubscribe)}function m(t){f(t)?t():t.unsubscribe()}var _={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},g={setTimeout:function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=g.delegate;return(null==o?void 0:o.setTimeout)?o.setTimeout.apply(o,p([t,e],a(r))):setTimeout.apply(void 0,p([t,e],a(r)))},clearTimeout:function(t){var e=g.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function w(){}var S=O("C",void 0,void 0);function O(t,e,r){return{kind:t,value:e,error:r}}var E=null;function j(t){if(_.useDeprecatedSynchronousErrorHandling){var e=!E;if(e&&(E={errorThrown:!1,error:null}),t(),e){var r=E,n=r.errorThrown,o=r.error;if(E=null,n)throw o}}else t()}var C=function(t){function e(e){var r=t.call(this)||this;return r.isStopped=!1,e?(r.destination=e,x(e)&&e.add(r)):r.destination=J,r}return u(e,t),e.create=function(t,e,r){return new P(t,e,r)},e.prototype.next=function(t){this.isStopped?I(O("N",t,void 0),this):this._next(t)},e.prototype.error=function(t){this.isStopped?I(O("E",void 0,t),this):(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?I(S,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(y),N=Function.prototype.bind;function T(t,e){return N.call(t,e)}var k=function(){function t(t){this.partialObserver=t}return t.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(t){A(t)}},t.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(t){A(t)}else A(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(t){A(t)}},t}(),P=function(t){function e(e,r,n){var o,i,s=t.call(this)||this;return f(e)||!e?o={next:null!=e?e:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:s&&_.useDeprecatedNextContext?((i=Object.create(e)).unsubscribe=function(){return s.unsubscribe()},o={next:e.next&&T(e.next,i),error:e.error&&T(e.error,i),complete:e.complete&&T(e.complete,i)}):o=e,s.destination=new k(o),s}return u(e,t),e}(C);function A(t){_.useDeprecatedSynchronousErrorHandling?_.useDeprecatedSynchronousErrorHandling&&E&&(E.errorThrown=!0,E.error=t):g.setTimeout(function(){var e=_.onUnhandledError;if(e)e(t);else throw t})}function I(t,e){var r=_.onStoppedNotification;r&&g.setTimeout(function(){return r(t,e)})}var J={closed:!0,next:w,error:function(t){throw t},complete:w},z="function"==typeof Symbol&&Symbol.observable||"@@observable";function F(t){return t}var D=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n,o=this,i=(n=t)&&n instanceof C||n&&f(n.next)&&f(n.error)&&f(n.complete)&&x(n)?t:new P(t,e,r);return j(function(){var t=o.operator,e=o.source;i.add(t?t.call(i,e):e?o._subscribe(i):o._trySubscribe(i))}),i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=M(e))(function(e,n){var o=new P({next:function(e){try{t(e)}catch(t){n(t),o.unsubscribe()}},error:n,complete:e});r.subscribe(o)})},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[z]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0===t.length?F:1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)})(this)},t.prototype.toPromise=function(t){var e=this;return new(t=M(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function M(t){var e;return null!==(e=null!=t?t:_.Promise)&&void 0!==e?e:Promise}var U=d(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),V=function(t){function e(){var e=t.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return u(e,t),e.prototype.lift=function(t){var e=new H(this,this);return e.operator=t,e},e.prototype._throwIfClosed=function(){if(this.closed)throw new U},e.prototype.next=function(t){var e=this;j(function(){var r,n;if(e._throwIfClosed(),!e.isStopped){e.currentObservers||(e.currentObservers=Array.from(e.observers));try{for(var o=c(e.currentObservers),i=o.next();!i.done;i=o.next())i.value.next(t)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}})},e.prototype.error=function(t){var e=this;j(function(){if(e._throwIfClosed(),!e.isStopped){e.hasError=e.isStopped=!0,e.thrownError=t;for(var r=e.observers;r.length;)r.shift().error(t)}})},e.prototype.complete=function(){var t=this;j(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var e=t.observers;e.length;)e.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(e){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var e=this,r=this.hasError,n=this.isStopped,o=this.observers;return r||n?b:(this.currentObservers=null,o.push(t),new y(function(){e.currentObservers=null,v(o,t)}))},e.prototype._checkFinalizedStatuses=function(t){var e=this.hasError,r=this.thrownError,n=this.isStopped;e?t.error(r):n&&t.complete()},e.prototype.asObservable=function(){var t=new D;return t.source=this,t},e.create=function(t,e){return new H(t,e)},e}(D),H=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return u(e,t),e.prototype.next=function(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)},e.prototype.error=function(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)},e.prototype.complete=function(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)},e.prototype._subscribe=function(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:b},e}(V),L=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return u(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r.closed||e.next(this._value),r},e.prototype.getValue=function(){var t=this.hasError,e=this.thrownError,r=this._value;if(t)throw e;return this._throwIfClosed(),r},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(V);function X(t){return t.map(t=>"string"==typeof t?{id:K(),type:"text",text:t,children:[]}:{...t,children:t.children.map(t=>null==t?void 0:t.id).filter(t=>!t)})}let Y=t=>{let[e,r]=(0,s.useState)(null==t?void 0:t.getValue());(0,s.useEffect)(()=>{let e=t.subscribe(t=>r(t));return()=>e.unsubscribe()},[t]);let n=e=>t.next(e);return[e,n]};function q(t,e,r){let n=t.slice(0,e),o=t.slice(e,r),i=t.slice(r);return[n,o,i]}function B(t){return JSON.parse(JSON.stringify(t.reduce((t,e)=>{let r=t.slice(0,-1),n=t.pop()||"";return"object"==typeof e||"object"==typeof n?[...r,n,e]:[...r,"".concat(n," ").concat(e)]},[])))}function K(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function G(t){let e={...t,children:t.children.map(t=>t.id)};return 0===t.children.length?[e]:[e,...t.children.flatMap(G)]}function Q(t){let e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"root",n={};return t.forEach(t=>{n[t.id]={...t,children:[]}}),t.forEach(t=>{t.id===r&&(e=n[t.id]);let o=n[t.id];o&&t.children.forEach(t=>{let e=n[t];e&&o.children.push(e)})}),e}function R(t){return t.reduce((t,e)=>({...t,[e.id]:e}),{})}let W={getText:()=>{try{var t;return(null==window?void 0:null===(t=window.localStorage)||void 0===t?void 0:t.getItem("onion"))||""}catch(t){return console.error("Could not restore data"),""}},setText:t=>{var e;null==window||null===(e=window.localStorage)||void 0===e||e.setItem("onion",t)}},Z=t=>{try{let e=JSON.parse(t);return e}catch(r){let e={id:"root",text:"Summary",type:"node",isOpen:!0,children:[{id:K(),type:"text",text:t,children:[]}]};return console.error("Could not parse import"),e}},$=Z(W.getText()),tt=new L($);tt.subscribe(t=>{console.warn(t),W.setText(JSON.stringify(t))});let te=t=>{let{text:e,isEditing:r,onSave:o}=t,[i,l]=(0,s.useState)(e),[u,c]=(0,s.useState)(!!r);return u?(0,n.jsx)("input",{autoFocus:!0,onKeyUp:t=>{"enter"===t.key.toLowerCase()&&(c(!1),null==o||o(i))},onBlur:t=>{c(!1),null==o||o(i)},value:i,onChange:t=>{l(t.target.value)}}):(0,n.jsx)("span",{onClick:()=>{c(!0)},children:i})},tr=t=>{let{isVisible:e,children:r}=t;return(0,n.jsx)("span",{style:{display:e?"initial":"none"},children:r})},tn=t=>{let{node:e,onCancel:r}=t,[o,i]=(0,s.useState)(!!(null==e?void 0:e.isOpen)),[l,u]=(0,s.useState)(null),[c,a]=(0,s.useState)(null),[p,f]=Y(tt);(0,s.useEffect)(()=>{let t=t=>{"Escape"===t.key&&(console.log("Escape key was pressed."),u(null),a(null))};return document.addEventListener("keyup",t),()=>document.removeEventListener("keyup",t)},[]);let[d,h]=(0,s.useState)([]);(0,s.useEffect)(()=>{e&&h(null==e?void 0:e.children.map(t=>{var e;return"text"===t.type?null===(e=t.text)||void 0===e?void 0:e.split(" "):t}).flat())},[e]);let v=t=>{a(t)},y=(t,e)=>{let r=R(G(p)),n=r[t];if(!n)return;r[t]={...n,...e};let o=JSON.parse(JSON.stringify(Q(Object.values(r))));f(o)},b=()=>{if(null===l||null===c)return;let[t,r,n]=q(d,l,c+1),o=K(),i=[...t,{id:o,text:"[name]",type:"node",isOpen:!1,isEditing:!0,children:B(r)},...n],s=R(G(p)),u=X(B(r)),a=R(B(i).map(t=>"string"==typeof t?{id:K(),type:"text",text:t,children:[]}:t.id===o?{...t,children:u.map(t=>{let{id:e}=t;return e})}:(console.warn("TEST",t),s[t.id]))),h={...R(u),...R(G(p)),...a,[e.id]:{...e,children:Object.values(a).map(t=>{let{id:e}=t;return e})}},v=JSON.parse(JSON.stringify(Q(Object.values(h))));f(v)},x=t=>{if(!l)return u(t);c&&(b(),u(null),a(null))},m=t=>{let r=d.findIndex(e=>"object"==typeof e&&e.id===t);if(r<0)return;let[n,o,i]=q(d,r,r+1),s=R(G(p)),l=R(X(B([...n,...d[r].children,...i]))),u={...l,...s,[e.id]:{...s[e.id],children:Object.values(l).map(t=>{let{id:e}=t;return e})}},c=JSON.parse(JSON.stringify(Q(Object.values(u))));f(c)},_=t=>t===l||l&&c&&c>l&&t>l&&t<=c?"#33333333":"unset";return(0,n.jsxs)("span",{className:"collapsible",children:[(0,n.jsx)("button",{className:"button",onClick:()=>{i(!o)},children:o?"-":"+"}),(0,n.jsx)(tr,{isVisible:!o,children:(0,n.jsx)(te,{text:(null==e?void 0:e.text)||"",isEditing:null==e?void 0:e.isEditing,onSave:t=>{(null==e?void 0:e.id)&&y(null==e?void 0:e.id,{text:t,isEditing:!1})}})}),(0,n.jsx)(tr,{isVisible:o,children:d.map((t,e)=>"object"==typeof t?(0,n.jsx)(tn,{node:t,onCancel:()=>m(t.id)},t.id):(null==t?void 0:t.match(/\n/))?(0,n.jsx)("br",{}):(0,n.jsxs)("span",{className:"hoverable",style:{background:_(e)},onClick:()=>x(e),onMouseOver:()=>v(e),children:[t," "]}))}),r&&(0,n.jsx)("button",{onClick:()=>{r()},children:"x"})]})},to=()=>{let[t,e]=Y(tt),[r,o]=(0,s.useState)(!1),[i,l]=(0,s.useState)(W.getText()),u=(0,s.useCallback)(()=>{if(o(!r),r&&i){let t=Z(i);e(t)}},[r,e,i]);return(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{children:(0,n.jsx)("button",{onClick:()=>(function(t){if(!navigator.clipboard){console.error("Clipboard API not available");return}navigator.permissions.query({name:"clipboard-write"}).then(e=>{"granted"==e.state||"prompt"==e.state?navigator.clipboard.writeText(t).then(function(){alert("Copied!"),console.log("Copying to clipboard was successful!")},function(t){console.error("Could not copy text: ",t)}):console.error("Permission to access clipboard is not granted")})})(JSON.stringify(t)),children:"Copy to clipboard"})}),r&&(0,n.jsx)("div",{children:(0,n.jsx)("textarea",{autoFocus:!0,onChange:t=>l(t.target.value),children:i})}),(0,n.jsx)("button",{onClick:()=>u(),children:r?"finish import":"import data"})]})};function ti(){let[t]=Y(tt);return(0,n.jsxs)("main",{className:"flex min-h-screen flex-col p-24 ".concat(i().className),children:[(0,n.jsx)("h2",{className:"mb-2 mt-0 text-5xl font-medium leading-tight text-primary",children:"Onion Summarization Tool"}),(0,n.jsx)(tn,{node:t}),(0,n.jsx)("br",{}),(0,n.jsx)(to,{})]})}},8993:function(t){t.exports={style:{fontFamily:"'__Inter_b22063', '__Inter_Fallback_b22063'",fontStyle:"normal"},className:"__className_b22063"}}},function(t){t.O(0,[774,888,179],function(){return t(t.s=8312)}),_N_E=t.O()}]);